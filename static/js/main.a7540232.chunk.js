(this["webpackJsonpsudoku-app"]=this["webpackJsonpsudoku-app"]||[]).push([[0],{113:function(e,t,n){"use strict";n.r(t);var r,c,a=n(1),s=n.n(a),i=n(15),o=n.n(i),l=(n(74),n(21)),d=n(37),u=n(5),j=n(19),f=n(18),v=n.n(f),b=n(31),O=n(58),h=n.n(O);n(76);!function(e){e[e.small=4]="small",e[e.normal=9]="normal"}(r||(r={})),function(e){e[e.EMPTY=0]="EMPTY",e[e.RUNNING=1]="RUNNING",e[e.STOPPED=2]="STOPPED",e[e.NEW=3]="NEW",e[e.FETCHING=4]="FETCHING",e[e.FINISHED=5]="FINISHED"}(c||(c={}));var m=n(23);function N(e){return e.map((function(e){return e.map((function(e){return{value:e,isCorrect:0!==e,isDeletable:0===e}}))}))}function x(e){var t,n=Object(m.a)(e);try{for(n.s();!(t=n.n()).done;){var r,c=t.value,a=Object(m.a)(c);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(!s.isCorrect||0===s.value)return!1}}catch(i){a.e(i)}finally{a.f()}}}catch(i){n.e(i)}finally{n.f()}return!0}var p=n(17),E=n.n(p),g=E.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URI}),S=r.normal,C=function(e){var t=new Array(e).fill(0).map((function(){return new Array(e).fill(0)}));return{solvedGrid:t,grid:N(t)}}(S),T=C.solvedGrid,I=C.grid,y=function(e,t){return{solvedGrid:T,grid:I,gameId:void 0,records:[],setGrid:function(t){var n=t.grid,r=t.solvedGrid,a=t.id,s=t.size,i=t.records;e((function(){return{solvedGrid:r,grid:N(n),gameId:a,records:i,state:c.NEW,size:s}}))},getCell:function(e,n){return t().grid[e][n]},setCell:function(n,r,a){var s=t().grid,i=t().size,o=s.map((function(e){return e.map((function(e){return e.value}))}));s[n][r].isCorrect=function(e,t,n,r,c){var a=Math.sqrt(c),s=Array.from({length:a},(function(e,t){return{from:t*a,to:(t+1)*a}}));if(!e[t].includes(r)){var i=e.map((function(e){return e[n]}));if(!i.includes(r)){var o,l=[],d=Object(m.a)(s);try{for(d.s();!(o=d.n()).done;){var u=o.value;if(t>=u.from&&t<u.to){var j,f=Object(m.a)(s);try{for(f.s();!(j=f.n()).done;){var v=j.value;if(n>=v.from&&n<v.to)for(var b=u.from;b<u.to;b++)for(var O=v.from;O<v.to;O++)l.push(e[b][O])}}catch(h){f.e(h)}finally{f.f()}}}}catch(h){d.e(h)}finally{d.f()}if(!l.includes(r))return!0}}return!1}(o,n,r,a,i),s[n][r].value=a;var l=x(s);e(l?{state:c.FINISHED,grid:s}:{grid:s})}}},_=h()((function(e,t){return Object(j.a)(Object(j.a)(Object(j.a)({},function(e,t){return{size:S,setSize:function(t){e({size:t})}}}(e)),y(e,t)),function(e,t){return{state:c.EMPTY,time:0,hints:0,setState:function(){var n=Object(b.a)(v.a.mark((function n(r,a){var s,i,o,l,d,u,j,f,b;return v.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r!==c.NEW){n.next=21;break}if(!a){n.next=9;break}return n.next=4,g.get("/games/".concat(a));case 4:s=n.sent,i=s.data.records,e({state:r,records:i,hints:0}),n.next=19;break;case 9:return n.next=11,g.get("/games/random/".concat(t().size));case 11:o=n.sent,l=o.data,d=l.grid,u=l.id,j=l.solvedGrid,f=l.size,b=l.records,e({state:r,grid:N(d),solvedGrid:j,size:f,gameId:u,records:b,hints:0});case 19:n.next=22;break;case 21:e({state:r});case 22:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),hint:function(){var n=t(),r=n.solvedGrid,a=n.grid;e:for(var s=0;s<a.length;s++)for(var i=a[s],o=0;o<i.length;o++){var l=i[o];if(0===l.value){l.value=r[s][o],l.isCorrect=!0;break e}}var d=x(a);e(d?{state:c.FINISHED,grid:a,hints:t().hints+1}:{grid:a,hints:t().hints+1})},setTime:function(t){e({time:t})},addRecord:function(n){e({records:t().records.concat(n)})}}}(e,t))}));var D=_,P=n(0);var R=function(e){var t=e.displayName,n=e.onClick,r=e.isActive,c=e.disabled;return Object(P.jsx)("input",{type:"button",className:"button-controller-button ".concat(r?"border":""),value:t,onClick:function(){return n()},disabled:c})};var A=function(){var e=D(),t=e.state,n=e.setState,r=e.hint;return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)(R,{displayName:t===c.RUNNING?"Stop":"Start",onClick:function(){t!==c.RUNNING?n(c.RUNNING):n(c.STOPPED)},isActive:!1,disabled:t===c.EMPTY||t===c.FETCHING||t===c.FINISHED||t===c.STOPPED}),Object(P.jsx)(R,{displayName:"New Game",onClick:function(){n(c.NEW)},isActive:!1,disabled:t===c.RUNNING}),Object(P.jsx)(R,{displayName:"Hint",onClick:function(){return r()},isActive:!1,disabled:t!==c.RUNNING})]})};var k=function(){var e=D(),t=e.size,n=e.setSize;return Object(P.jsxs)("div",{className:"size-controller",children:[Object(P.jsx)(R,{displayName:r[r.small],onClick:function(){return n(r.small)},isActive:t===r.small}),Object(P.jsx)(R,{displayName:r[r.normal],onClick:function(){return n(r.normal)},isActive:t===r.normal})]})},G=n(59);var U=function(){var e=D(),t=e.state,n=e.setTime,r=e.hints,s=Object(G.useStopwatch)({autoStart:!1}),i=s.seconds,o=s.minutes,l=s.pause,d=s.reset;return Object(a.useEffect)((function(){t===c.RUNNING?d():(l(),n(i+60*o))}),[t]),Object(P.jsxs)("div",{className:"clock",children:[Object(P.jsxs)("div",{className:"minutes",children:[Object(P.jsx)("div",{className:"first",children:Object(P.jsx)("div",{className:"number",children:Math.floor(o/10)})}),Object(P.jsx)("div",{className:"second",children:Object(P.jsx)("div",{className:"number",children:o%10})})]}),Object(P.jsx)("div",{className:"tick",children:":"}),Object(P.jsxs)("div",{className:"seconds",children:[Object(P.jsx)("div",{className:"first",children:Object(P.jsx)("div",{className:"number",children:Math.floor(i/10)})}),Object(P.jsx)("div",{className:"second infinite",children:Object(P.jsx)("div",{className:"number",children:i%10})})]}),Object(P.jsx)("div",{className:"hint_plus",children:"+"}),Object(P.jsxs)("div",{className:"hint_seconds",children:[Object(P.jsx)("div",{className:"first",children:Object(P.jsx)("div",{className:"number",children:Math.floor(30*r/10)})}),Object(P.jsx)("div",{className:"second infinite",children:Object(P.jsx)("div",{className:"number",children:30*r%10})})]})]})};var w=function(){var e=D((function(e){return e.gameId}));return Object(P.jsxs)("div",{className:"control-panel",children:[Object(P.jsxs)("div",{className:"control-panel-header",children:[Object(P.jsx)(U,{}),Object(P.jsx)("h3",{children:e||""})]}),Object(P.jsx)(A,{}),Object(P.jsx)(k,{})]})},F=n(22),H=n.n(F),W=n(32),z=function(e){return new Date(1e3*e).toISOString().substr(14,5)};var M=function(){var e=D(),t=e.setState,n=e.time,r=e.gameId,s=e.hints,i=Object(a.useState)(""),o=Object(W.a)(i,2),d=o[0],u=o[1],j=E.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URI}),f=Object(l.useMutation)((function(e){return j.post("/records",e)}),{onSuccess:function(){t(c.NEW,r)}});return Object(P.jsxs)("div",{children:[Object(P.jsxs)("p",{children:["Your total score is: ",z(n+60*s)]}),Object(P.jsx)("input",{type:"text",onChange:function(e){return u(e.target.value)},value:d,placeholder:"Insert your username...."}),Object(P.jsx)(R,{displayName:"Don't upload",onClick:function(){return t(c.EMPTY)}}),Object(P.jsx)(R,{displayName:"Upload",onClick:function(){var e={gameId:r||"",score:n+60*s,userName:d};f.mutate(e)},disabled:0===(null===d||void 0===d?void 0:d.length)})]})},K={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",display:"flex",justifyContent:"space-around",flexWrap:"wrap"}},L=function(e){return 0===e?"":e};var B=function(e){var t=e.row,n=e.column,r=e.hasBorder,s=e.value,i=e.isDeletable,o=e.size;H.a.setAppElement("#root");for(var l=D(),d=l.setCell,u=l.state,j=Object(a.useState)(!1),f=Object(W.a)(j,2),v=f[0],b=f[1],O=[],h=function(e){O.push(Object(P.jsx)("div",{className:"value-input",onClick:function(){d(t,n,e)},children:0===e?"-":e},e))},m=0;m<o+1;m++)h(m);return Object(P.jsxs)("div",{className:"cell ".concat(r?"border":""," ").concat(v?"active":""," ").concat(i?"":"fix"),onClick:function(){return b(i&&!v)},children:[Object(P.jsx)("span",{className:u===c.NEW?"blur":"",children:L(s)}),Object(P.jsx)(H.a,{isOpen:v,onAfterClose:function(){return b(!1)},style:K,children:O.map((function(e){return e}))})]})};function Y(e,t){return(e+1)%Math.sqrt(t)===0}var V=function(e){for(var t=e.index,n=e.row,r=[],c=0;c<n.length;c++){var a=Object(P.jsx)(B,{hasBorder:Y(c,n.length),row:t,column:c,size:n.length,value:n[c].value,isDeletable:n[c].isDeletable},c);r.push(a)}return Object(P.jsx)("div",{className:Y(t,n.length)?"row border":"row",children:r.map((function(e){return e}))})},q=E.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URI}),J={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",display:"flex",justifyContent:"space-around",flexWrap:"wrap"}};var Q=function(){var e=Object(u.e)().id,t=D(),n=t.grid,r=t.state,s=t.setState,i=t.setGrid,o=[];Object(a.useEffect)((function(){function t(){return(t=Object(b.a)(v.a.mark((function t(){var n,r;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q.get("/games/".concat(e),{validateStatus:function(e){return e<500}});case 2:n=t.sent,r=n.data,200===n.status&&i(r);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]);for(var l=0;l<n.length;l++)o.push(Object(P.jsx)(V,{index:l,row:n[l]},l));return Object(P.jsxs)("div",{className:"grid",children:[o.map((function(e){return e})),Object(P.jsx)(H.a,{isOpen:r===c.FINISHED,onAfterClose:function(){return s(c.EMPTY)},style:J,children:Object(P.jsx)(M,{})})]})},X=Q;var Z=function(){var e=D((function(e){return e.records}));return Object(P.jsxs)("div",{children:[Object(P.jsx)("h2",{children:"Leaderboard "}),e.length?e.map((function(e,t){return Object(P.jsxs)("div",{className:"record-entry",children:[Object(P.jsxs)("h4",{children:[t+1,"."]}),Object(P.jsx)("h3",{children:z(e.score)}),Object(P.jsx)("p",{children:e.userName})]},t)})):Object(P.jsx)("div",{className:"record-entry",children:Object(P.jsx)("p",{children:Object(P.jsx)("i",{children:"Nobody finished this game yet "})})})]})};var $=function(){var e=new l.QueryClient;return Object(P.jsx)(l.QueryClientProvider,{client:e,children:Object(P.jsx)(d.a,{children:Object(P.jsxs)("div",{className:"app",children:[Object(P.jsx)(u.a,{path:"/:id",children:Object(P.jsx)(X,{})}),Object(P.jsx)(u.a,{exact:!0,path:"/",children:Object(P.jsx)(X,{})}),Object(P.jsxs)("div",{className:"left-side",children:[Object(P.jsx)(w,{}),Object(P.jsx)(Z,{})]})]})})})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,116)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};o.a.render(Object(P.jsx)(s.a.StrictMode,{children:Object(P.jsx)($,{})}),document.getElementById("root")),ee()},74:function(e,t,n){}},[[113,1,2]]]);
//# sourceMappingURL=main.a7540232.chunk.js.map